---
layout: post
title: 实习项目总结  2014-06-26 到 2014-08-02
category: life
tags: life
---

###项目一 :  Bae Runtime 环境搭建

#####>项目简介

  <p>由于Bae从2.0升级到3.0导致和我们部门PHP运行环境不一样,以至于外包出去的代码和我们整合时需要修改的地方太多了,为了实现外包商的开发环境和我们线上的PHP运行环境一致,我们部门制作一个兼容Bae2.0的runtime自定义运行环境.</p>

#####>项目技术  

  <p>参见Baidu云技术文档进行制作参见[玩转Bae](http://godbae.duapp.com/?p=781)</p>

#####>技术难点  

 <p>对于我来说以前只是对Linux 命令有了解,技术水平就是会一个cd mkdir之类的,主要的难点还是Linux操作还有就是对PHP环境的转变,以前了解的PHP环境的都是通过Apache通过模块的方式来加载的，这边主要是通过fast-cgi来运行，服务器采用lighttpd,我想环境不熟悉和linux命令(shell脚本不熟悉)是这个项目的最大难点</p>

#####>关键点      

 <P>项目关键在与将PHP项目迁移到这个环境上可以完美运行,并且长时间稳定</P>

#####>问题及方案

1. 在lighttpd运行时会涉及到名单的问题，我在搭建runtime测试的时候忘记了加给测试域名添加白名单,服务器报502错误
2. 失误吧ip地址写错导致把BAE3.0对外的开放数据库连不上,自己马虎导致
3. 清除不需要的库(包括PHP和lighttpd的),安全问题

#####>项目收获

1. 做事不要马虎,做任何事都要用心
2. 对Linux熟悉程度又增加了一步
3. 又再次了解了PHP的fast-cgi常驻进程网关运行模式
4. 了解了shell脚本,以后会系统学习shell脚本编程

<br/><br/>
---
<br/><br/>

###项目二: 壁纸频道后台数据,后台搜索展示

#####>项目简介

<P>练手项目,项目主要是提供能录入图片,上传到云端然后可以对图片进行分类,编辑图片信息,包含title,资源链接等信息。然后对外在突出以以json为格式的http接口</p>

#####>技术难点

<p>其实要是只是先这么一些功能的话好像是没有什么技术难点,就是建表,建表是设计的索引添加以及查询优化什么的,然后就是对数据库的增删改查,真正的难点是在原有的框架上上进行开发</p>

#####>关键点

1. 在原有的框架上开发,不能影响原有的业务逻辑代码
2. 数据库建表，添加索引，查询优化

#####>问题及方案
1. svn 代码时直接讲一个全局配置变量覆盖了，这是致命的错误,全局配置一出问题那整个业务线都有受到影响,解决办法svn版本回滚
2. 调用上传图片时接口始终不成功,原因是调用接口时不能有文件名后缀
3. 上线的各种问题


#####>项目收获
1. 阅读框架收获,了解这边数据库架构的方式
2. 在ci代码时,只提交自己更新的代码,不能覆盖原来的代码,尤其是操作影响全局的文件时
3. 在ci代码时,必须进行diff

<br/><br/>
---
<br/><br/>
###项目三:七夕活动2014

#####>项目简介
<P>七夕活动,为情侣提供一个表白地方，同时也成为了打广告的地方，用户可以再这里发表自己的爱宣言</P>

#####>技术难点

1. 高访问量，数据库优化，缓存优化
2. 提供无线端接口(跨域问题，多接口，访问数据库的次数)
3. 无线端数据格式和PC端数据不统一,查表多次
4. 登陆问题的判断(包括三方登陆)
5. 短期项目迭代，压力大

#####>关键点

1. 程序性能,缓存级别
2. xss防范
3. 跨域问题(jsonp)  注： jsonp有一个安全问题 返回的时候前面最好加上 /**/ 并且对callback做正则匹配
4. 接口详细设计,包括错误编号以及对应的信息都要详细

#####>问题及方案
1. 在开发是项目下有两套框架,用错框架(用的框架不能喝fe模块联调得迁移框架)导致浪费时间太多，还好业务逻辑不算太复杂,在前辈的帮助下迁移了5个小时左右
2. 跨域请求无法传递COOKIE给PC(我),导致我不能获取用户信息,个人觉得是无线的问题，最后把COOKIE的值作为query传递，安全隐患比较大
3. 在开发时获取用户信息的LIB库调用错误,调用了一个不稳定的,导致线上有时不能准确的获取用户信息,原因有个人的原因也有LIB库太杂乱，还好现在在开发同一个SDK库
4. 第三方登陆BUG,这个问题比较严重的,究其原因是接口设计时的问题,少了一个字段标识是否登陆.在用户点击告白的时候前端也没有判断是否登陆(因为告白时有4种情况 A.该用户已经告白过 B.改用户没有告白过(是否带shareURL*2) ) 最后为了不影响已有的功能添加一个字段标识是否登陆
5. 数据库报警,在上线第二天由于访问人过多导致数据库报警，报警原因数据库查询时分页太多,导致mysql扫描了很多不用的数据,还有就是缓存时间设为了3秒少了一个0 解决办法: 关闭无线端的分页接口，因为他们已经不用了，防止发现接口的人恶意请求接口,限制PC接口分页数,将缓存设置为120秒 cache用的是zcache类似memcache
6. 在运行过程中CMS数据配送失败,很正常,重新启动


#####>项目收获
1. 数据接口设计必须要规范详细，包括错误编号定义，以及每个字段的详细说明，中途修改要及时通知
2. 在编码前要进行仔细的设计,这样在迭代时才不容易犯错
3. 线上出问题时要准确的定位,这次数据库报警时有监控的,要是没有监控怎么办?项目日志是非常重要的
4. 在开发的时候要随时和团队交流,不要等到要联调时才沟通，这样出了问题没有时间解决,要是紧急项目(或者是赶时间点的)那就只有OVER了

#####>访问数据

> 8月1日 -8月2日 3,7444,406 UV / 5,174,105PV
> 总计写入数据库 ： 427302 条记录